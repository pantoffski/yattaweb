webpackJsonp([1],{0:function(t,e,a){a("j1ja"),t.exports=a("bicQ")},"3W4f":function(t,e){},"3wOC":function(t,e,a){"use strict";function n(t){a("qmAy")}var s=a("lgts"),r=a("yKLb"),i=a("VU/8"),c=n,o=i(s.a,r.a,!1,c,null,null);e.a=o.exports},"4vft":function(t,e,a){"use strict";var n=a("NYxO"),s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t};e.a={name:"raceViewer",data:function(){return{lastUpdate:0,isUpload:!1,sortBy:"updatedAt",di:1,columnClass:{tagId:"",chk1:"",chk2:"",chk3:"",updatedAt:"down",isDq:""}}},methods:s({getRunner:function(){var t=this;console.log("getRunner"),this.$http.post("/apinaja/runners/"+this.lastUpdate).then(function(e){console.log(e),e.data.length>0&&(t.lastUpdate=e.data[0].updatedAt)})},addTagColumn:function(){console.log("addTagColumn"),this.$http.post("/apinaja/addTagColumn").then(function(t){return console.log(t)})},resetData:function(){console.log("resetData"),this.$http.post("/apinaja/resetRace").then(function(t){return console.log(t)}),this.clearTag()},startRace:function(){console.log("startRace"),this.$http.post("/apinaja/startRace",{gunTime:(new Date).getTime()}).then(function(t){return console.log(t)})},getGunTime:function(){console.log("startRace"),this.$http.post("/apinaja/getGunTime").then(function(t){return console.log(t)})},setSortBy:function(t){for(var e in this.columnClass)this.columnClass[e]="";this.sortBy!=t?(this.sortBy=t,this.di=1):this.di=-1*this.di,this.columnClass[this.sortBy]=1==this.di?"down":"up"}},Object(n.b)(["clearTag"])),mounted:function(){},computed:s({sortedTags:function(){var t=this.sortBy,e=this.di;return this.tags.sort(function(a,n){return a[t]===n[t]?0:1*a[t]<1*n[t]?1*e:-1*e})}},Object(n.c)({isConnected:function(t){return t.isConnected},tags:function(t){return t.tags},message:function(t){return t.message}})),watch:{},components:{}}},"5yWD":function(t,e){},"9DDJ":function(t,e,a){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}var s=a("7+uW"),r=a("NYxO"),i=a("hMcO"),c=a.n(i),o=a("mtWM"),u=a.n(o);s.a.use(r.a);var l=new r.a.Store({state:{isConnected:!1,needInitRaceName:!1,sortBy:2,di:1,updatedAt:0,tags:[],message:[]},getters:{},mutations:{SOCKET_CONNECT:function(t,e){t.isConnected=!0},SOCKET_DISCONNECT:function(t,e){t.isConnected=!1},addMessage:function(t,e){var a=new Date;e=a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()+" - "+e;var s=[e].concat(n(t.message));s=s.splice(0,20),t.message=s},clearTag:function(t,e){t.tags=[],t.message=[]},addTags:function(t,e){t.updatedAt=e[0].updatedAt;var a=t.tags,s=[];for(var r in e){var i=e[r].tagId,c=a.findIndex(function(t){return t.tagId==i});c<0?s.push(e[r]):a[c]=e[r]}t.tags=[].concat(n(a),s)}},actions:{socket_tagStat:function(t,e){var a=t.commit,n=t.dispatch;a("addMessage",e),n("getData")},getData:function(t){var e=t.commit,a=t.state;u.a.post("/runnersWithData/"+a.updatedAt).then(function(t){t.data.length>0&&e("addTags",t.data)})}}});s.a.use(c.a,"https://yattaweb.herokuapp.com/",l),e.a=l},BTy9:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("router-view")],1)},s=[],r={render:n,staticRenderFns:s};e.a=r},"Eo+V":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"boardHead"},[a("div",{class:["mainCat",this.isClear?"hide":""]},[t._v(t._s(t.mainCat))]),t._v(" "),a("div",{class:["subCat",this.isClear?"hide":""]},[t._v(t._s(t.subCat))]),t._v(" "),a("div",{class:["gender",this.isClear?"hide":""]})])},s=[],r={render:n,staticRenderFns:s};e.a=r},KA7w:function(t,e,a){"use strict";function n(t){a("PWV4")}var s=a("qz81"),r=a("kHDC"),i=a("VU/8"),c=n,o=i(s.a,r.a,!1,c,null,null);e.a=o.exports},OzJ6:function(t,e,a){"use strict";var n=a("7+uW"),s=a("/ocq"),r=a("ZuMv"),i=a("djIV");n.a.use(s.a),e.a=new s.a({mode:"history",base:"/",routes:[{path:"/",name:"raceViewer",component:r.a},{path:"/scoreBoard",name:"scoreBoard",component:i.a},{path:"*",redirect:"/"}]})},PI1J:function(t,e,a){"use strict";function n(t){a("3W4f")}var s=a("z+r0"),r=a("Eo+V"),i=a("VU/8"),c=n,o=i(s.a,r.a,!1,c,null,null);e.a=o.exports},PWV4:function(t,e){},T87K:function(t,e){},ZuMv:function(t,e,a){"use strict";function n(t){a("5yWD")}var s=a("4vft"),r=a("aC5R"),i=a("VU/8"),c=n,o=i(s.a,r.a,!1,c,null,null);e.a=o.exports},aC5R:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"raceViewer"}},[a("h3",{class:t.isConnected?"connected":""},[t._v("cmd center")]),a("br"),t._v(" tags : "+t._s(t.sortedTags.length)+"\r\n  "),a("br"),a("br"),t._v(" "),a("div",{staticClass:"logContainer"},t._l(t.message,function(e){return a("div",[t._v(t._s(e))])})),t._v(" "),a("br"),a("br"),t._v(" "),a("button",{on:{click:t.startRace}},[t._v("startRace")]),t._v(" "),a("button",{on:{click:t.resetData}},[t._v("resetData")]),t._v(" "),a("button",{on:{click:t.addTagColumn}},[t._v("addTagColumn")]),t._v(" "),a("br"),t._v(" "),a("table",{attrs:{border:"1"}},[a("thead",[a("tr",[a("td",[a("span",{class:t.columnClass.tagId,on:{click:function(e){t.setSortBy("tagId")}}},[t._v("tagId")])]),t._v(" "),a("td",[a("span",{class:t.columnClass.chk1,on:{click:function(e){t.setSortBy("chk1")}}},[t._v("chk1")])]),t._v(" "),a("td",[a("span",{class:t.columnClass.chk2,on:{click:function(e){t.setSortBy("chk2")}}},[t._v("chk2")])]),t._v(" "),a("td",[a("span",{class:t.columnClass.chk3,on:{click:function(e){t.setSortBy("chk3")}}},[t._v("chk3")])]),t._v(" "),a("td",[a("span",{class:t.columnClass.updatedAt,on:{click:function(e){t.setSortBy("updatedAt")}}},[t._v("updatedAt")])]),t._v(" "),a("td",[a("span",{class:t.columnClass.isDq,on:{click:function(e){t.setSortBy("isDq")}}},[t._v("isDq")])])])]),t._v(" "),a("tbody",t._l(t.sortedTags,function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(e.tagId))]),t._v(" "),a("td",[t._v(t._s(e.chk1))]),t._v(" "),a("td",[t._v(t._s(e.chk2))]),t._v(" "),a("td",[t._v(t._s(e.chk3))]),t._v(" "),a("td",[t._v(t._s(e.updatedAt))]),t._v(" "),a("td",[t._v(t._s(e.isDq))])])}))])])},s=[],r={render:n,staticRenderFns:s};e.a=r},bicQ:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("mtWM"),s=a.n(n),r=a("7+uW"),i=a("NYxO"),c=a("OzJ6"),o=a("9DDJ"),u=a("creg"),l=a("hMcO");a.n(l);r.a.use(i.a),s.a.defaults.baseURL="/apinaja",r.a.prototype.$http=s.a,new r.a({el:"#app",store:o.a,router:c.a,template:"<App/>",sockets:{},components:{App:u.a},created:function(){console.log("app created"),this.$store.dispatch("getData")}})},creg:function(t,e,a){"use strict";var n=a("wCqm"),s=a("BTy9"),r=a("VU/8"),i=r(n.a,s.a,!1,null,null,null);e.a=i.exports},djIV:function(t,e,a){"use strict";function n(t){a("T87K")}var s=a("q9Bu"),r=a("ov6q"),i=a("VU/8"),c=n,o=i(s.a,r.a,!1,c,null,null);e.a=o.exports},kHDC:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"card",class:[t.cardClass,t.isHide]},[t._v(t._s(" "==t.ch?"Â ":t.ch))])},s=[],r={render:n,staticRenderFns:s};e.a=r},lgts:function(t,e,a){"use strict";var n=a("KA7w");e.a={name:"cardContainer",props:["left","top","txt","delay","startDelay","isClear"],data:function(){return{cards:[],dispIdx:-1}},watch:{txt:function(t){var e=this;this.dispIdx=-1,this.cards=this.splitString(t),""==t?this.cards=[]:setTimeout(function(){e.aniLoop()},this.startDelay)}},methods:{aniLoop:function(){var t=this;this.dispIdx<this.cards.length&&(this.dispIdx++,setTimeout(function(){t.aniLoop()},this.delay))},splitString:function(t){var e,a,n=[];if(!t||""==t)return n;var s=document.createElement("canvas").getContext("2d");s.font="monospace 10px;";var r=t.split("");for(e=r.splice(0,1)+"",a=s.measureText(e).width;r.length>0;){s.measureText(e+r[0]).width/a>1.2?(n.push(e),e=r.splice(0,1)+""):e+=r.splice(0,1),a=s.measureText(e).width}return n.push(e),n.slice(0,28)}},components:{card:n.a}}},ov6q:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{style:t.boardStyle,attrs:{id:"scoreBoard"}},[a("em",{class:["rank",this.isClear||"overall"==this.raceCat?"hide":""]},[a("hr")]),t._v(" "),a("em",{class:["rank",this.isClear||"overall"==this.raceCat?"hide":""]},[a("hr")]),t._v(" "),a("em",{class:["rank",this.isClear||"overall"==this.raceCat?"hide":""]},[a("hr")]),t._v(" "),a("cardContainer",{attrs:{startDelay:0,top:192,txt:t.winners[0],delay:t.delay,isClear:t.isClear,left:145}}),t._v(" "),a("cardContainer",{attrs:{startDelay:500,top:258,txt:t.winners[1],delay:t.delay,isClear:t.isClear,left:145}}),t._v(" "),a("cardContainer",{attrs:{startDelay:1e3,top:324,txt:t.winners[2],delay:t.delay,isClear:t.isClear,left:145}}),t._v(" "),a("cardContainer",{attrs:{startDelay:1500,top:390,txt:t.winners[3],delay:t.delay,isClear:t.isClear,left:145}}),t._v(" "),a("cardContainer",{attrs:{startDelay:2e3,top:456,txt:t.winners[4],delay:t.delay,isClear:t.isClear,left:145}}),t._v(" "),t._l(t.blubs,function(t,e){return a("b",{key:"index",class:["blub",t]})}),t._v(" "),a("boardHead",{attrs:{raceCat:t.raceCat,isClear:t.isClear}})],2),t._v(" "),a("div",{style:t.boardStyle,attrs:{id:"guide"}})])},s=[],r={render:n,staticRenderFns:s};e.a=r},q9Bu:function(t,e,a){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}var s=a("PI1J"),r=a("3wOC");e.a={name:"scoreBoard",data:function(){return{dispTime:10,blubs:this.genBlubs(),blubTimer:null,isClear:!0,delay:150,raceCat:"50f",screenWidth:100,screenHeight:100,winners:["","","","",""],raw:null}},methods:{dispWinner:function(){var t=this;for(var e in this.raw){console.log(e),this.isClear=!1,this.raceCat=e,this.winners=["","","","",""],this.$nextTick(function(){this.winners=this.raw[e].slice(0,5),delete this.raw[e]});break}1==Object.keys(this.raw).length&&this.$http.post("/getOverall").then(function(e){t.raw=e.data}),setTimeout(function(){return t.clear()},1e3*this.dispTime)},getScreenSize:function(){this.screenWidth=window.innerWidth,this.screenHeight=window.innerHeight},genBlubs:function(){for(var t=["on","","","","","","","",""],e=[];e.length<90;)e=[].concat(n(e),t);return e},shiftBlubs:function(){var t=this.blubs,e=t.splice(-1);this.blubs=[].concat(n(e),n(t))},clear:function(){var t=this;this.isClear=!0,setTimeout(function(){return t.dispWinner()},3e3)},setText:function(){this.isClear=!1,this.t1="",this.t2="",this.str1="",this.str2="",this.$nextTick(function(){this.t1="55:59",this.t2="",this.str1=this.inp1,this.str2=this.inp1})}},computed:{boardStyle:function(){var t,e,a;return t=Math.min(this.screenWidth/1155,this.screenHeight/576),e=(this.screenWidth-1155*t)/2,a=(this.screenHeight-576*t)/2,{transform:"scale("+t+")",left:e+"px",top:a+"px"}}},created:function(){var t=this;this.blubTimer=setInterval(function(){t.shiftBlubs()},600),this.$http.post("/getOverall").then(function(e){t.raw=e.data,t.dispWinner()})},beforeDestroy:function(){clearInterval(this.blubTimer)},mounted:function(){window.addEventListener("resize",this.getScreenSize),this.$nextTick(function(){this.getScreenSize()})},components:{cardContainer:r.a,boardHead:s.a}}},qmAy:function(t,e){},qz81:function(t,e,a){"use strict";e.a={name:"card",props:["ch","isClear"],data:function(){return{cardClass:""}},computed:{isHide:function(){return" "==this.ch?"hide":"show"}},watch:{isClear:function(t){var e=this;t&&setTimeout(function(t){Math.random()>.5?e.cardClass="fadeLeft":e.cardClass="fadeRight"},1e3*Math.random())}}}},wCqm:function(t,e,a){"use strict";a("NYxO");e.a={name:"app",data:function(){return{}},methods:{},computed:{foo:function(){return"bar"}}}},yKLb:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cardContainer",style:{left:t.left+"px",top:t.top+"px"}},t._l(t.cards,function(e,n){return n<=t.dispIdx?a("card",{key:n,attrs:{ch:e,isClear:t.isClear}}):t._e()}))},s=[],r={render:n,staticRenderFns:s};e.a=r},"z+r0":function(t,e,a){"use strict";e.a={name:"boardHead",props:["raceCat","isClear"],data:function(){return{}},computed:{mainCat:function(){return"overall"==this.raceCat?"over":"m"==this.raceCat.slice(-1)?"male":"female"},subCat:function(){if("overall"==this.raceCat)return"all";var t=this.raceCat.slice(0,2),e=this.raceCat.slice(-1);return isNaN(1*t)?t:(t*=1,0==t?"< 25 Y.":60==t&&"m"==e?"> 60 Y.":50==t&&"f"==e?"> 50 Y.":t+"-"+(t+4)+" Y.")}}}}},[0]);
//# sourceMappingURL=main.js.map?ae2c33a6fd66e580de7e